<!DOCTYPE html>
@using BE.Roles;
@{ 
    var Style = "";
}

<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>@ViewBag.Title -РБР</title>


    @RenderSection("scripts", required: false)
    <script src="https://code.jquery.com/jquery-1.9.1.min.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/2.0.1/css/toastr.css" rel="stylesheet" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/2.0.1/js/toastr.js"></script>
    <script src="~/Scripts/jquery.maskedinput.min.js"></script>
    @{
        var location = new Uri($"{Context.Request.Scheme}://{Context.Request.Host}{Context.Request.Path}{Context.Request.QueryString}");
        var url = location.AbsoluteUri;
    }

    
    @if (url.Contains(":80"))
    {
        Style = "red!important";
    }
</head>
<body>
   
    <div class="navbar navbar-inverse navbar-fixed-top" style="background-color: @Style" >
        <div id="wrapper">
            <div id="sidebar-wrapper">
                <div class="TimeAndDate"  style="background-color: @Style">
                    <div id="Date"></div>
                    <div style="display: inline-flex;">
                        <div id="hours">:</div>
                        <div id="point">:</div>
                        <div id="min">:</div>
                        <div id="point">:</div>
                        <div id="sec">:</div>
                    </div>
                </div>
            </div>
        </div>
        <div class="container">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <img style="float: left; width: auto; height: 20px; margin-top: 15px;" src="~/Content/img/main/БРБ_лого.png" />
                @Html.ActionLink("ООО Расчетно-биллинговые решения", "Index", "Home", new { area = "" }, new { @class = "navbar-brand" })
            </div>
            <div class="navbar-collapse collapse">
                <ul class="nav navbar-nav">
                    <li>@Html.ActionLink("Домашняя страница", "Index", "Home")</li>
                    @*<li>@Html.ActionLink("Поиск", "Index", "Counter")</li>*@
                </ul>
                @Html.Partial("_LoginPartial")
            </div>
        </div>
    </div>
   @if (User.Identity.IsAuthenticated)
   {


    <div id="wrapper2" class="toggled-2" >
        <!-- Sidebar -->
        <div id="sidebar-wrapper2">
            <ul class="sidebar-nav nav-pills nav-stacked" id="menu">
                <li id="Billing" class="active">
                    <a href="/Counter"><i class="glyphicon glyphicon-search icons" aria-hidden="true"></i> <i class="Padding">Биллинг Т+</i></a>
                </li>
                <li id="DPU">
                    @if (User.IsInRole(@RolesEnums.DPUReader) || User.IsInRole(@RolesEnums.DPUEdit) || User.IsInRole(RolesEnums.Admin) || User.IsInRole(RolesEnums.SuperAdmin))
                    {
                        <a href="/DPU"><i class="glyphicon glyphicon-ruble icons" aria-hidden="true"></i> <i class="Padding">ДПУ</i></a>
                    }
                    @*<ul class="nav-pills nav-stacked" style="list-style-type:none;">
                        <li><a href="#"><span class="fa-stack fa-lg pull-left"><i class="fa fa-flag fa-stack-1x "></i></span>Пример1</a></li>
                        <li><a href="#"><span class="fa-stack fa-lg pull-left"><i class="fa fa-flag fa-stack-1x "></i></span>Пример2</a></li>
                    </ul>*@
                </li>
                <li id="Report">
                    <a href="/Report"><i class="glyphicon glyphicon-list-alt icons" aria-hidden="true"></i> <i class="Padding">Отчеты</i></a>
                </li>
                @if (User.IsInRole(RolesEnums.Admin) || User.IsInRole(RolesEnums.CounterReader) || User.IsInRole(RolesEnums.CounterWriter) || User.IsInRole(RolesEnums.CourtAdmin))
                {
                     <li id="Court">
                        <a href="/Court/Serach"><i class="glyphicon glyphicon-queen icons" aria-hidden="true"></i> <i class="Padding">Судебные дела</i></a>
                    </li>
                }
                <hr />
                <li style="bottom: 0px; position: absolute; bottom: 0px; " >
                    <p style="color:white; margin-left:35px;" >Ссылки на другие системы</p>
                </li>
            </ul>
        </div>
        <!-- /#sidebar-wrapper -->
        <!-- Page Content -->
        @*<div id="page-content-wrapper">
            <div class="container-fluid xyz">
                <div class="row">
                    <div class="col-lg-12">
                        <h1>Simple Admin Sidebar With Bootstrap by <a href="http://http://codepen.io/hughbalboa/">hughbalboa</a></h1>
                        <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Provident laudantium nobis cum dignissimos ex inventore, velit blanditiis. Quod laborum soluta quidem culpa officia eligendi, quam, recusandae iste aliquid amet odit! </p>
                    </div>
                </div>
            </div>
        </div>*@
    </div>
   }
    <!-- /#page-content-wrapper -->
    @if (User.Identity.IsAuthenticated && (User.IsInRole("Admin") || User.IsInRole("Notifications")))
    {
        <div id="NotificationResultTimer"></div>
    }
    <div class="container body-content">
        @RenderBody()
    </div>
</body>
<script>
    function initMenu() {
        $('#menu ul').hide();
        $('#menu ul').children('.current').parent().show();
        //$('#menu ul:first').show();
        $('#menu li a').click(
            function () {
                var checkElement = $(this).next();
                if ((checkElement.is('ul')) && (checkElement.is(':visible'))) {
                    return false;
                }
                if ((checkElement.is('ul')) && (!checkElement.is(':visible'))) {
                    $('#menu ul:visible').slideUp('normal');
                    checkElement.slideDown('normal');
                    return false;
                }
            }
        );
    }
    $(document).ready(function () {
        let HREF = window.location.href;
        //if (!HREF.includes(":80")) {
        //    console.log("setStyle")
        //    $("#navBars").css("background-color:", "#f1058c !important;");
        //}
        $("#menu li.active").removeClass("active");
        if (HREF.includes("DPU")) {
            $("#DPU").addClass("active");
        } else if (HREF.includes("Counter") || HREF.includes("PersonalData") ) {
            $("#Billing").addClass("active");
        } else if (HREF.includes("Report")) {
            $("#Report").addClass("active");
        } else if (HREF.includes("Court")) {
            $("#Court").addClass("active");
        }
        console.log(HREF);
        initMenu();
    });
    setInterval(function () {
        $.ajax({
            url: '/Admin/GetNotification',
            success: function (data) {
                $("#NotificationResultTimer").empty();
                $("#NotificationResultTimer").append(data);
            },
            error: function () {
                i = "Что то пошло не так. Обратитесь к администратору!";
            }
        });
    }, 30000);
    $.ajax({
        url: '/Admin/GetNotification',
        success: function (data) {
            $("#NotificationResultTimer").empty();
            $("#NotificationResultTimer").append(data);
        },
        error: function () {
            i = "Что то пошло не так. Обратитесь к администратору!";
        }
    });
    function MenuBottomonOn() {
        $("#MenuBottom").removeClass('hidden');
        $("#ButtonMenuBottom").addClass('hidden');
    }
    function MenuBottomonOff() {
        $("#MenuBottom").addClass('hidden');
        $("#ButtonMenuBottom").removeClass('hidden');
    }
    $(document).ready(function (e) {
        
        // Создаем две переменные с названиями месяцев и названиями дней.
        var monthNames = ["Январь", "Февраль", "Март", "Апрель", "Май", "Июнь", "Июль", "Август", "Сентябрь", "Октябрь", "Ноябрь", "Декабрь"];
        var dayNames = ["Воскресенье", "Понедельник", "Вторник", "Среда", "Четверг", "Пятница", "Суббота"]

        // Создаем объект newDate()
        var newDate = new Date();
        // "Достаем" текущую дату из объекта Date
        newDate.setDate(newDate.getDate());
        // Получаем день недели, день, месяц и год
        $('#Date').html(dayNames[newDate.getDay()] + " " + newDate.getDate() + ' ' + monthNames[newDate.getMonth()] + ' ' + newDate.getFullYear());

        setInterval(function () {
            // Создаем объект newDate() и показывает секунды
            var seconds = new Date().getSeconds();
            // Добавляем ноль в начало цифры, которые до 10
            $("#sec").html((seconds < 10 ? "0" : "") + seconds);
        }, 1000);

        setInterval(function () {
            // Создаем объект newDate() и показывает минуты
            var minutes = new Date().getMinutes();
            // Добавляем ноль в начало цифры, которые до 10
            $("#min").html((minutes < 10 ? "0" : "") + minutes);
        }, 1000);

        setInterval(function () {
            // Создаем объект newDate() и показывает часы
            var hours = new Date().getHours();
            // Добавляем ноль в начало цифры, которые до 10
            $("#hours").html((hours < 10 ? "0" : "") + hours);
        }, 1000);
    });
</script>
</html>
