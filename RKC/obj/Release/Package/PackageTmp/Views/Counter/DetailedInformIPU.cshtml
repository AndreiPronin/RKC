@model IEnumerable<DB.Model.IPU_COUNTERS>
@using System.Text.RegularExpressions;
@{
    ViewBag.Title = "DetailedInformIPU";
    string TypePU = "";
    var Index = 1;


}
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jquery-confirm/3.3.2/jquery-confirm.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-confirm/3.3.2/jquery-confirm.min.js"></script>
@if (string.IsNullOrEmpty(ViewBag.FULL_LIC))
{
    <div class="container">
        <h3 class="text-center">Детальная информация по лицевому счету  @Model.FirstOrDefault().FULL_LIC</h3>
        <p class="text-center NullOrEmpty">Красным выделена отсутствующая информация</p>
        <div class="col-md-12">
            <button id="CloseLock" name="@Model.FirstOrDefault().FULL_LIC" class="btn btn-success">Закрыть страницу</button>
            @if (!ViewBag.isLock)
            {
                if (ViewBag.ZAK != true && ViewBag.LockAddPu != true)
                {
                    <input type="button" name="@Model.FirstOrDefault().FULL_LIC" class="btn btn-primary AddPU"
                           value="Добавить ПУ" data-toggle="modal" data-target="#AddPUModal" />
                }
            }
            <a href="/counter/DetailedInformIPUDelete?FULL_LIC=@Model.FirstOrDefault().FULL_LIC" target="_blank"><input type="button" class="btn btn-primary" value="История ранее установленых ПУ" /></a>
            <a href="/PersonalData/DetailedInformPersData?FULL_LIC=@Model.FirstOrDefault().FULL_LIC" target="_blank" data-tooltip="Закройте редактирование при переходе...">
                <input type="button" class="btn btn-primary PersData" value="Персональные данные" />
            </a>
            <a href="/PersonalData/PersonalInformation?FullLic=@Model.FirstOrDefault().FULL_LIC"><input type="button" class="btn btn-primary" value="Страница детальной информации" /></a>
        </div>
        <div id="ResultSearchSave"></div>
    </div>
    <div class="loader">
        <div class="inner one"></div>
        <div class="inner two"></div>
        <div class="inner three"></div>
    </div>
    <div class="row">
        @foreach (var Items in Model)
        {

            <div style="margin-top:10px;" class="card">
                <div class="card-header text-center">
                    <input id="FULL_LIC" value="@Items.FULL_LIC" hidden="hidden" />
                    @if (!string.IsNullOrEmpty(Items.TYPE_PU))
                    {
                        <div class="col-md-6">
                            <p>Тип ПУ:  <input type="text" disabled="disabled" id="TYPE_PU" name="@Items.ID_PU" class="form-control" value="@Items.TYPE_PU" /> </p>
                        </div>
                        <div class="col-md-6">
                            <p>ID ПУ в ГИС:  <input type="text" disabled="disabled" id="TYPE_PU" name="@Items.ID_PU" class="form-control" value="@Items.GIS_ID_PU" /> </p>
                        </div>
                    }
                    else
                    {<p class="NullOrEmpty">Тип ПУ:</p>}
                    @foreach (var Item in ViewBag.ErrorIntegration)
                    {
                        if (Item.TypePu == Items.TYPE_PU)
                        {
                            <p class="NullOrEmpty">Ошибка интеграции начальный @Item.InitialReadings конечные @Item.EndReadings текущие @Item.NowReadings <br />
                                    @Item.Description</p>
                        }
                    }

                </div>
                <hr />
                <div class="card-body field">
                    <input hidden="hidden" class="TypePU" value="@Items.TYPE_PU" />
                    <div class="col-md-12">
                        <div class="col-md-6">
                            <div class="form-group row">
                                @if (Items.INSTALLATIONDATE != null)
                                {
                                    <label class="col-sm-4 col-form-label">Дата акта ввода:</label>
                                    <div class="col-sm-8">
                                        <input type="date" readonly="readonly" tabIndex="@Index@{Index++;}" id="INSTALLATIONDATE" max="@DateTime.Now.Date.AddDays(0).ToString("yyyy-MM-dd")" class="form-control" value="@string.Format("{0:yyyy-MM-dd}", Items.INSTALLATIONDATE)" />
                                    </div>
                                }
                                else
                                {

                                    <label class="col-sm-4 NullOrEmpty col-form-label">Дата акта ввода:</label>
                                    <div class="col-sm-8">
                                        <input type="date" readonly="readonly" tabIndex="@Index@{Index++;}" id="INSTALLATIONDATE" max="@DateTime.Now.Date.AddDays(0).ToString("yyyy-MM-dd")" class="form-control" value="@string.Format("{0:yyyy-MM-dd}", Items.INSTALLATIONDATE)" />
                                    </div>

                                }
                            </div>
                            <hr />
                            <div class="form-group row">
                                @if (!string.IsNullOrEmpty(Items.FACTORY_NUMBER_PU))
                                {
                                    <label class="col-sm-4 col-form-label"> Номер ПУ:</label>
                                    <div class="col-sm-8">
                                        <input type="text" name="@Items.FULL_LIC" tabIndex="@Index@{Index++;}" readonly="readonly" id="NumberPU" class="form-control" value="@Items.FACTORY_NUMBER_PU" />
                                    </div>
                                }
                                else
                                {
                                    <label class="col-sm-4 NullOrEmpty col-form-label">Номер ПУ:</label>
                                    <div class="col-sm-8">
                                        <input type="text" name="@Items.FULL_LIC" tabIndex="@Index@{Index++;}" readonly="readonly" id="NumberPU" class="form-control" value="@Items.FACTORY_NUMBER_PU" />
                                    </div>
                                }
                            </div>
                            <input hidden="hidden" class="IdPU" value="@Items.ID_PU" />
                            <hr />
                            <div class="form-group row">
                                @{var BRAND_PU = Items.BRAND_PU != null ? Items.BRAND_PU : "";}
                                @if (string.IsNullOrEmpty(Items.BRAND_PU))
                                {
                                    <label style="font-weight:inherit;" class="col-sm-4 NullOrEmpty col-form-label;">Бренд ПУ:</label>
                                }
                                else
                                {
                                    <label style="font-weight:inherit;" class="col-sm-4 col-form-label;">Бренд ПУ:</label>
                                }
                                <div class="col-sm-8">
                                    <select disabled id="BRAND_PU" tabIndex="@Index@{Index++;}" class="form-control BRAND_PU">
                                        <option value="@BRAND_PU">@BRAND_PU</option>
                                        @{var TypePu = Regex.Replace(Items.TYPE_PU, "[0-9]", "");}
                                        @foreach (var Item in Items.BrandDictionary.Where(x => x.TYPE_PU == TypePu))
                                        {
                                            <option value="@Item.ID">@Item.BRAND_NAME</option>
                                        }
                                    </select>
                                </div>
                            </div>
                            <hr />
                            <div class="form-group row">
                                @{var MODEL_PU = Items.MODEL_PU != null ? Items.MODEL_PU : "";}
                                @if (string.IsNullOrEmpty(Items.MODEL_PU))
                                {
                                    <label style="font-weight:inherit;" class="col-sm-4 NullOrEmpty col-form-label;">Модель ПУ:</label>
                                }
                                else
                                {
                                    <label style="font-weight:inherit;" class="col-sm-4 col-form-label;">Модель ПУ:</label>
                                }
                                <div class="col-sm-8">
                                    <select disabled id="MODEL_PU" tabIndex="@Index@{Index++;}" class="form-control MODEL_PU">
                                        <option value="@MODEL_PU">@MODEL_PU</option>
                                    </select>

                                </div>
                            </div>
                            <hr />
                            <div class="form-group row">
                                @if (Items.DATE_CHECK != null)
                                {
                                    <label class="col-sm-4 col-form-label">Дата поверки:</label>
                                    <div class="col-sm-8">

                                        <input type="date" readonly="readonly" tabIndex="@Index@{Index++;}" max="@DateTime.Now.Date.AddDays(0).ToString("yyyy-MM-dd")" id="DATE_CHECK" class="form-control" value="@string.Format("{0:yyyy-MM-dd}", Items.DATE_CHECK)" />
                                    </div>
                                }
                                else
                                {
                                    <label class="col-sm-4 NullOrEmpty col-form-label">Дата поверки:</label>
                                    <div class="col-sm-8">
                                        <input type="date" readonly="readonly" tabIndex="@Index@{Index++;}" max="@DateTime.Now.Date.AddDays(0).ToString("yyyy-MM-dd")" id="DATE_CHECK" class="form-control" value="@string.Format("{0:yyyy-MM-dd}", Items.DATE_CHECK)" />
                                    </div>
                                }

                            </div>
                            <hr />
                            <div class="form-group row">
                                @if (Items.DATE_CHECK_NEXT != null)
                                {
                                    <label class="col-sm-4 col-form-label">Дата следующей поверки:</label>
                                    <div class="col-sm-8">
                                        <input type="date" readonly="readonly" tabIndex="@Index@{Index++;}" max="@DateTime.Now.Date.AddYears(6).ToString("yyyy-MM-dd")" id="DATE_CHECK_NEXT" class="form-control" value="@string.Format("{0:yyyy-MM-dd}", Items.DATE_CHECK_NEXT)" />
                                    </div>
                                }
                                else
                                {
                                    <label class="col-sm-4 NullOrEmpty col-form-label">Дата следующей поверки:</label>
                                    <div class="col-sm-8">
                                        <input type="date" readonly="readonly" tabIndex="@Index@{Index++;}" max="@DateTime.Now.Date.AddYears(6).ToString("yyyy-MM-dd")" id="DATE_CHECK_NEXT" class="form-control" value="@string.Format("{0:yyyy-MM-dd}", Items.DATE_CHECK_NEXT)" />
                                    </div>
                                }
                            </div>
                            <hr />
                            <div class="form-group row">
                                <label class="col-sm-4 col-form-label">Межповерочный интервал:</label>
                                <div class="col-sm-8">
                                    <select disabled id="InterVerificationInterval" class="form-control">
                                        <option>@Items.InterVerificationInterval</option>
                                        <option value="4">4</option>
                                        <option value="5">5</option>
                                        <option value="6">6</option>
                                    </select>
                                </div>
                            </div>
                            <hr />
                            <div class="form-group row">
                                @if (Items.CHECKPOINT_DATE != null)
                                {
                                    <label class="col-sm-4 col-form-label">Дата контрольного обхода:</label>
                                    <div class="col-sm-8">
                                        <input type="date" readonly="readonly" tabIndex="@Index@{Index++;}" id="CHECKPOINT_DATE" class="form-control" value="@string.Format("{0:yyyy-MM-dd}", Items.CHECKPOINT_DATE)" />
                                    </div>
                                }
                                else
                                {
                                    <label class="col-sm-4 NullOrEmpty col-form-label">Дата контрольного обхода:</label>
                                    <div class="col-sm-8">
                                        <input type="date" readonly="readonly" tabIndex="@Index@{Index++;}" id="CHECKPOINT_DATE" class="form-control" value="@string.Format("{0:yyyy-MM-dd}", Items.CHECKPOINT_DATE)" />
                                    </div>
                                }

                            </div>
                            <hr />
                            <div class="form-group row">
                                @if (Items.CHECKPOINT_READINGS != null)
                                {
                                    <label class="col-sm-4 col-form-label">Показания контролера:</label>
                                    <div class="col-sm-8">
                                        <input type="text" step="0.001" id="CHECKPOINT_READINGS" tabIndex="@Index@{Index++;}" readonly="readonly" class="form-control CHECKPOINT_READINGS" value="@Items.CHECKPOINT_READINGS" />
                                    </div>
                                }
                                else
                                {
                                    <label class="col-sm-4 NullOrEmpty col-form-label">Показания контролера:</label>
                                    <div class="col-sm-8">
                                        <input type="text" step="0.001" id="CHECKPOINT_READINGS" tabIndex="@Index@{Index++;}" readonly="readonly" class="form-control CHECKPOINT_READINGS" value="@Items.CHECKPOINT_READINGS" />
                                    </div>
                                }
                            </div>
                            <hr />
                            <div class="form-group row">
                                @if (Items.OPERATOR_CLOSE_DATE != null)
                                {
                                    <label class="col-sm-4 col-form-label">Дата закрытия:</label>
                                    <div class="col-sm-8">
                                        <input type="date" readonly="readonly" tabIndex="@Index@{Index++;}" id="OPERATOR_CLOSE_DATE" class="form-control" value="@string.Format("{0:yyyy-MM-dd}", Items.OPERATOR_CLOSE_DATE)" />
                                    </div>
                                }
                                else
                                {
                                    <label class="col-sm-4 NullOrEmpty col-form-label">Дата закрытия:</label>
                                    <div class="col-sm-8">
                                        <input type="date" readonly="readonly" tabIndex="@Index@{Index++;}" id="OPERATOR_CLOSE_DATE" class="form-control" value="@string.Format("{0:yyyy-MM-dd}", Items.OPERATOR_CLOSE_DATE)" />
                                    </div>
                                }
                            </div>
                            <hr />
                            <div class="form-group row">
                                @if (Items.OPERATOR_CLOSE_READINGS != null)
                                {
                                    <label class="col-sm-4 col-form-label">К.П. при закрытии:</label>
                                    <div class="col-sm-8">
                                        <input type="text" id="OPERATOR_CLOSE_READINGS" tabIndex="@Index@{Index++;}" readonly="readonly" class="form-control OPERATOR_CLOSE_READINGS" value="@Items.OPERATOR_CLOSE_READINGS" />
                                    </div>
                                }
                                else
                                {
                                    <label class="col-sm-4 NullOrEmpty col-form-label">К.П. при закрытии:</label>
                                    <div class="col-sm-8">
                                        <input type="text" id="OPERATOR_CLOSE_READINGS" tabIndex="@Index@{Index++;}" readonly="readonly" class="form-control OPERATOR_CLOSE_READINGS" value="@Items.OPERATOR_CLOSE_READINGS" />
                                    </div>
                                }

                            </div>
                            <hr />
                        </div>
                        <div class="col-md-6">
                            <div class="form-group row">
                                @if (Items.TYPEOFSEAL != null)
                                {
                                    <label class="col-sm-4 col-form-label">Тип пломбы1:</label>
                                    <div class="col-sm-8">
                                        <select disabled id="TYPEOFSEAL" class="form-control">
                                            <option>@Items.TYPEOFSEAL</option>
                                            <option value="Антимагнитная">Антимагнитная</option>
                                            <option value="Стандартная">Стандартная</option>
                                        </select>
                                        @*<input type="text" readonly="readonly" tabIndex="@Index@{Index++;}" id="TYPEOFSEAL" class="form-control" value="@Items.TYPEOFSEAL" />*@
                                    </div>
                                }
                                else
                                {
                                    <label class="col-sm-4 NullOrEmpty col-form-label">Тип пломбы1:</label>
                                    <div class="col-sm-8">
                                        <select disabled id="TYPEOFSEAL" class="form-control">
                                            <option>@Items.TYPEOFSEAL</option>
                                            <option value="Антимагнитная">Антимагнитная</option>
                                            <option value="Стандартная">Стандартная</option>
                                        </select>
                                        @*<input type="text" readonly="readonly" tabIndex="@Index@{Index++;}" id="TYPEOFSEAL" class="form-control" value="@Items.TYPEOFSEAL" />*@
                                    </div>
                                }

                            </div>
                            <hr />
                            <div class="form-group row">
                                @if (Items.SEALNUMBER != null)
                                {
                                    <label class="col-sm-4 col-form-label">Номер пломбы1:</label>
                                    <div class="col-sm-8">
                                        <input type="text" readonly="readonly" tabIndex="@Index@{Index++;}" id="SEALNUMBER" class="form-control" value="@Items.SEALNUMBER" />
                                    </div>
                                }
                                else
                                {
                                    <label class="col-sm-4 NullOrEmpty col-form-label">Номер пломбы1:</label>
                                    <div class="col-sm-8">
                                        <input type="text" readonly="readonly" tabIndex="@Index@{Index++;}" id="SEALNUMBER" class="form-control" value="@Items.SEALNUMBER" />
                                    </div>
                                }

                            </div>
                            <hr />
                            <div class="form-group row">
                                @if (Items.TYPEOFSEAL2 != null)
                                {
                                    <label class="col-sm-4 col-form-label">Тип пломбы2:</label>
                                    <div class="col-sm-8">
                                        <select disabled id="TYPEOFSEAL2" class="form-control">
                                            <option>@Items.TYPEOFSEAL2</option>
                                            <option value=""></option>
                                            <option value="Антимагнитная">Антимагнитная</option>
                                            <option value="Стандартная">Стандартная</option>
                                        </select>
                                        @*<input type="text" readonly="readonly" tabIndex="@Index@{Index++;}" id="TYPEOFSEAL" class="form-control" value="@Items.TYPEOFSEAL" />*@
                                    </div>
                                }
                                else
                                {
                                    <label class="col-sm-4 NullOrEmpty col-form-label">Тип пломбы2:</label>
                                    <div class="col-sm-8">
                                        <select disabled id="TYPEOFSEAL2" class="form-control">
                                            <option>@Items.TYPEOFSEAL2</option>
                                            <option value=""></option>
                                            <option value="Антимагнитная">Антимагнитная</option>
                                            <option value="Стандартная">Стандартная</option>
                                        </select>
                                        @*<input type="text" readonly="readonly" tabIndex="@Index@{Index++;}" id="TYPEOFSEAL" class="form-control" value="@Items.TYPEOFSEAL" />*@
                                    </div>
                                }

                            </div>
                            <hr />
                            <div class="form-group row">
                                @if (Items.SEALNUMBER2 != null)
                                {
                                    <label class="col-sm-4 col-form-label">Номер пломбы2:</label>
                                    <div class="col-sm-8">
                                        <input type="text" readonly="readonly" tabIndex="@Index@{Index++;}" id="SEALNUMBER2" class="form-control" value="@Items.SEALNUMBER2" />
                                    </div>
                                }
                                else
                                {
                                    <label class="col-sm-4 NullOrEmpty col-form-label">Номер пломбы2:</label>
                                    <div class="col-sm-8">
                                        <input type="text" readonly="readonly" tabIndex="@Index@{Index++;}" id="SEALNUMBER2" class="form-control" value="@Items.SEALNUMBER2" />
                                    </div>
                                }

                            </div>
                            <hr />
                            @{var I = Items.ALL_LICS.FKUBSXVS == 0 ? "нет ИПУ" : Items.ALL_LICS.FKUBSXVS == 1 ? "расчет по ИПУ" : Items.ALL_LICS.FKUBSXVS == 2 ? "расчет по среднему" : Items.ALL_LICS.FKUBSXVS == 3 ? "расчет по нормативу" : "";}
                            @if (!string.IsNullOrEmpty(I) && Items.TYPE_PU == "ГВС1")
                            {
                                <p>Признак ИПУ: ГВС 1 @I</p>
                                <div class="form-group row">
                                    <label class="col-sm-4 col-form-label"> Начальные показания: </label>
                                    <div class="col-sm-8">
                                        <input type="text" id="FKUB1XVS" tabIndex="@Index@{Index++;}" readonly="readonly" class="form-control Saled SaledConfirm1" value="@Items.ALL_LICS.FKUB1XVS" />
                                    </div>
                                    <label class="col-sm-4 col-form-label"> Конечные показания: </label>
                                    <div class="col-sm-8">
                                        <input type="text" id="FKUB2XVS" tabIndex="@Index@{Index++;}" readonly="readonly" class="form-control Saled SaledConfirm2" value="@Items.ALL_LICS.FKUB2XVS" />
                                    </div>
                                    <label class="col-sm-4 col-form-label"> Объем: </label>
                                    <div class="col-sm-8">
                                        @{var obem = Items.ALL_LICS.FKUB2XVS - Items.ALL_LICS.FKUB1XVS; }
                                        <input type="text" disabled="disabled" class="form-control obem" value="@obem" />
                                    </div>
                                </div>
                                { TypePU = "FKUB1XVS"; }
                            }
                            @{ I = Items.ALL_LICS.FKUBSXV_2 == 0 ? "нет ИПУ" : Items.ALL_LICS.FKUBSXV_2 == 1 ? "расчет по ИПУ" : ""; }
                            @if (!string.IsNullOrEmpty(I) && Items.TYPE_PU == "ГВС2")
                            {
                                <p>Признак ИПУ: ГВС 2 @I</p>
                                <div class="form-group row">
                                    <label class="col-sm-4 col-form-label"> Начальные показания: </label>
                                    <div class="col-sm-8">
                                        <input type="text" id="FKUB1XV_2" tabIndex="@Index@{Index++;}" readonly="readonly" class="form-control Saled SaledConfirm1" value="@Items.ALL_LICS.FKUB1XV_2" />
                                    </div>
                                    <label class="col-sm-4 col-form-label"> Конечные показания: </label>
                                    <div class="col-sm-8">
                                        <input type="text" id="FKUB2XV_2" tabIndex="@Index@{Index++;}" readonly="readonly" class="form-control Saled SaledConfirm2" value="@Items.ALL_LICS.FKUB2XV_2" />
                                    </div>
                                    <label class="col-sm-4 col-form-label"> Объем: </label>
                                    <div class="col-sm-8">
                                        @{var obem = Items.ALL_LICS.FKUB2XV_2 - Items.ALL_LICS.FKUB1XV_2; }
                                        <input type="text" disabled="disabled" class="form-control obem" value="@obem" />
                                    </div>
                                </div>
                                { TypePU = "FKUB1XV_2"; }
                            }
                            @{ I = Items.ALL_LICS.FKUBSXV_3 == 0 ? "нет ИПУ" : Items.ALL_LICS.FKUBSXV_3 == 1 ? "расчет по ИПУ" : Items.ALL_LICS.FKUBSXV_3 == 2 ? "расчет по среднему" : Items.ALL_LICS.FKUBSXV_3 == 3 ? "расчет по нормативу" : ""; }
                            @if (!string.IsNullOrEmpty(I) && Items.TYPE_PU == "ГВС3")
                            {
                                <p>Признак ИПУ: ГВС 3 @I</p>
                                <div class="form-group row">
                                    <label class="col-sm-4 col-form-label"> Начальные показания: </label>
                                    <div class="col-sm-8">
                                        <input type="text" id="FKUB1XV_3" tabIndex="@Index@{Index++;}" readonly="readonly" class="form-control Saled SaledConfirm1" value="@Items.ALL_LICS.FKUB1XV_3" />
                                    </div>
                                    <label class="col-sm-4 col-form-label"> Конечные показания: </label>
                                    <div class="col-sm-8">
                                        <input type="text" id="FKUB2XV_3" tabIndex="@Index@{Index++;}" readonly="readonly" class="form-control Saled SaledConfirm2" value="@Items.ALL_LICS.FKUB2XV_3" />
                                    </div>
                                    <label class="col-sm-4 col-form-label"> Объем: </label>
                                    <div class="col-sm-8">
                                        @{var obem = Items.ALL_LICS.FKUB2XV_3 - Items.ALL_LICS.FKUB1XV_3; }
                                        <input type="text" disabled="disabled" class="form-control obem" value="@obem" />
                                    </div>
                                </div>
                                { TypePU = "FKUB1XV_3"; }
                            }
                            @{ I = Items.ALL_LICS.FKUBSXV_4 == 0 ? "нет ИПУ" : Items.ALL_LICS.FKUBSXV_4 == 1 ? "расчет по ИПУ" : ""; }
                            @if (!string.IsNullOrEmpty(I) && Items.TYPE_PU == "ГВС4")
                            {
                                <p>Признак ИПУ: ГВС 4 @I</p>
                                <div class="form-group row">
                                    <label class="col-sm-4 col-form-label"> Начальные показания: </label>
                                    <div class="col-sm-8">
                                        <input type="text" id="FKUB1XV_4" tabIndex="@Index@{Index++;}" readonly="readonly" class="form-control Saled SaledConfirm1" value="@Items.ALL_LICS.FKUB1XV_4" />
                                    </div>
                                    <label class="col-sm-4 col-form-label"> Конечные показания: </label>
                                    <div class="col-sm-8">
                                        <input type="text" id="FKUB2XV_4" tabIndex="@Index@{Index++;}" readonly="readonly" class="form-control Saled SaledConfirm2" value="@Items.ALL_LICS.FKUB2XV_4" />
                                    </div>
                                    <label class="col-sm-4 col-form-label"> Объем: </label>
                                    <div class="col-sm-8">
                                        @{var obem = Items.ALL_LICS.FKUB2XV_4 - Items.ALL_LICS.FKUB1XV_4; }
                                        <input type="text" disabled="disabled" class="form-control obem" value="@obem" />
                                    </div>
                                </div>
                                { TypePU = "FKUB1XV_4"; }
                            }

                            @{ I = Items.ALL_LICS.FKUBSOT_1 == 0 ? "нет ИПУ" : Items.ALL_LICS.FKUBSOT_1 == 1 ? "расчет по ИПУ" : Items.ALL_LICS.FKUBSOT_1 == 2 ? "расчет по среднему" : Items.ALL_LICS.FKUBSOT_1 == 3 ? "расчет по нормативу" : ""; }
                            @if (!string.IsNullOrEmpty(I) && Items.TYPE_PU == "ОТП1")
                            {
                                <p>Признак ИПУ: отопление 1 @I</p>
                                <div class="form-group row">
                                    <label class="col-sm-4 col-form-label"> Начальные показания: </label>
                                    <div class="col-sm-8">
                                        <input type="text" id="FKUB1OT_1" tabIndex="@Index@{Index++;}" readonly="readonly" class="form-control Saled SaledConfirm1" value="@Items.ALL_LICS.FKUB1OT_1" />
                                    </div>
                                    <label class="col-sm-4 col-form-label"> Конечные показания: </label>
                                    <div class="col-sm-8">
                                        <input type="text" id="FKUB2OT_1" tabIndex="@Index@{Index++;}" readonly="readonly" class="form-control Saled SaledConfirm2" value="@Items.ALL_LICS.FKUB2OT_1" />
                                    </div>
                                    <label class="col-sm-4 col-form-label"> Объем: </label>
                                    <div class="col-sm-8">
                                        @{var obem = Items.ALL_LICS.FKUB2OT_1 - Items.ALL_LICS.FKUB1OT_1; }
                                        <input type="text" disabled="disabled" class="form-control obem" value="@obem" />
                                    </div>
                                </div>
                                { TypePU = "FKUB1OT_1"; }
                            }

                            @{ I = Items.ALL_LICS.FKUBSOT_2 == 0 ? "нет ИПУ" : Items.ALL_LICS.FKUBSOT_2 == 1 ? "расчет по ИПУ" : ""; }
                            @if (!string.IsNullOrEmpty(I) && Items.TYPE_PU == "ОТП2")
                            {
                                <p>Признак ИПУ: отопление 2 @I</p>
                                <div class="form-group row">
                                    <label class="col-sm-4 col-form-label"> Начальные показания: </label>
                                    <div class="col-sm-8">
                                        <input type="text" id="FKUB1OT_2" tabIndex="@Index@{Index++;}" readonly="readonly" class="form-control Saled SaledConfirm1" value="@Items.ALL_LICS.FKUB1OT_2" />
                                    </div>
                                    <label class="col-sm-4 col-form-label"> Конечные показания: </label>
                                    <div class="col-sm-8">
                                        <input type="text" id="FKUB2OT_2" tabIndex="@Index@{Index++;}" readonly="readonly" class="form-control Saled SaledConfirm2" value="@Items.ALL_LICS.FKUB2OT_2" />
                                    </div>
                                    <label class="col-sm-4 col-form-label"> Объем: </label>
                                    <div class="col-sm-8">
                                        @{var obem = Items.ALL_LICS.FKUB2OT_2 - Items.ALL_LICS.FKUB1OT_2; }
                                        <input type="text" disabled="disabled" class="form-control obem" value="@obem" />
                                    </div>
                                </div>
                                { TypePU = "FKUB1OT_2"; }
                            }

                            @{ I = Items.ALL_LICS.FKUBSOT_3 == 0 ? "нет ИПУ" : Items.ALL_LICS.FKUBSOT_3 == 1 ? "расчет по ИПУ" : ""; }
                            @if (!string.IsNullOrEmpty(I) && Items.TYPE_PU == "ОТП3")
                            {
                                <p>Признак ИПУ: отопление 3 @I</p>
                                <div class="form-group row">
                                    <label class="col-sm-4 col-form-label"> Начальные показания: </label>
                                    <div class="col-sm-8">
                                        <input type="text" id="FKUB1OT_3" tabIndex="@Index@{Index++;}" readonly="readonly" class="form-control Saled SaledConfirm1" value="@Items.ALL_LICS.FKUB1OT_3" />
                                    </div>
                                    <label class="col-sm-4 col-form-label"> Конечные показания: </label>
                                    <div class="col-sm-8">
                                        <input type="text" id="FKUB2OT_3" tabIndex="@Index@{Index++;}" readonly="readonly" class="form-control Saled SaledConfirm2" value="@Items.ALL_LICS.FKUB2OT_3" />
                                    </div>
                                    <label class="col-sm-4 col-form-label"> Объем: </label>
                                    <div class="col-sm-8">
                                        @{var obem = Items.ALL_LICS.FKUB2OT_3 - Items.ALL_LICS.FKUB1OT_3; }
                                        <input type="text" disabled="disabled" class="form-control obem" value="@obem" />
                                    </div>
                                </div>
                                { TypePU = "FKUB1OT_3"; }
                            }

                            @{ I = Items.ALL_LICS.FKUBSOT_4 == 0 ? "нет ИПУ" : Items.ALL_LICS.FKUBSOT_4 == 1 ? "расчет по ИПУ" : ""; }
                            @if (!string.IsNullOrEmpty(I) && Items.TYPE_PU == "ОТП4")
                            {
                                <p>Признак ИПУ: отопление 4 @I</p>
                                <div class="form-group row">
                                    <label class="col-sm-4 col-form-label"> Начальные показания: </label>
                                    <div class="col-sm-8">
                                        <input type="text" id="FKUB1OT_4" tabIndex="@Index@{Index++;}" readonly="readonly" class="form-control Saled SaledConfirm1" value="@Items.ALL_LICS.FKUB1OT_4" />
                                    </div>
                                    <label class="col-sm-4 col-form-label"> Конечные показания: </label>
                                    <div class="col-sm-8">
                                        <input type="text" id="FKUB2OT_4" tabIndex="@Index@{Index++;}" readonly="readonly" class="form-control Saled SaledConfirm2" value="@Items.ALL_LICS.FKUB2OT_4" />
                                    </div>
                                    <label class="col-sm-4 col-form-label"> Объем: </label>
                                    <div class="col-sm-8">
                                        @{var obem = Items.ALL_LICS.FKUB2OT_4 - Items.ALL_LICS.FKUB1OT_4; }
                                        <input type="text" disabled="disabled" class="form-control obem" value="@obem" />
                                    </div>
                                </div>
                                { TypePU = "FKUB1OT_4"; }
                            }
                            <div class="form-group row">
                                <label class="col-sm-4 col-form-label">Дата последних показаний:</label>
                                <div class="col-sm-8">
                                    <input type="date" disabled="disabled" class="form-control" value="@string.Format("{0:yyyy-MM-dd}", Items.LastReadingDate)" />
                                </div>
                            </div>
                            <div class="form-group row">
                                <label class="col-sm-4 col-form-label">Записать показания:</label>
                                <div class="col-sm-8">
                                    <input type="checkbox" disabled class="OVERWRITE" />
                                </div>
                            </div>
                            <div class="form-group row">
                                @{var DIMESSIONS = Items.DIMENSION != null ? Items.DIMENSION.DIMENSION_NAME : "";}
                                @{var DIMESSIONSID = Items.DIMENSION != null ? Items.DIMENSION.ID : 0;}
                                @if (string.IsNullOrEmpty(DIMESSIONS))
                                {
                                    <label style="font-weight:inherit;" class="col-sm-4 NullOrEmpty col-form-label;">Единица измерения:</label>
                                }
                                else
                                {
                                    <label style="font-weight:inherit;" class="col-sm-4 col-form-label;">Единица измерения:</label>
                                }
                                <div class="col-sm-8">
                                    <select disabled id="DIMENSION" class="form-control">

                                        <option value="@DIMESSIONSID">@DIMESSIONS</option>
                                        @foreach (var Item in ViewBag.DIMENSION)
                                        {
                                            <option value="@Item.ID">@Item.DIMENSION_NAME</option>
                                        }
                                    </select>
                                </div>
                            </div>
                            <div class="form-group row">
                                @if (!string.IsNullOrEmpty(Items.DESCRIPTION))
                                {
                                    <label class="col-sm-4 col-form-label">Примечание:</label>
                                    <div class="col-sm-8">
                                        <textarea name="DESCRIPTION" class="form-control DESCRIPTION">@Items.DESCRIPTION</textarea>
                                    </div>
                                }
                                else
                                {
                                    <label class="col-sm-4 NullOrEmpty col-form-label">Примечание:</label>
                                    <div class="col-sm-8">
                                        <textarea name="DESCRIPTION" class="form-control DESCRIPTION">@Items.DESCRIPTION</textarea>
                                    </div>
                                }
                            </div>

                        </div>
                    </div>

                    @if (!ViewBag.isLock)
                    {
                        <input type="button" name="@Items.FULL_LIC-@TypePU" class="btn btn-primary Archive" value="История расчётов ИПУ" data-toggle="modal" data-target="#ArchiveModal" />
                        <input type="button" value="Сохранить" class="btn btn-danger hidden  Save" />
                        <input type="button" name="@Items.ID_PU" value="Редактировать" class="btn btn-success Edit" />
                         if (ViewBag.ErrorIntegration.Count > 0)
                         {
                            <input type="button" name="@Items.ID_PU" value="Убрать ошибку" class="btn btn-success DeleteError hidden" />
                         }
                        <input type="button" value="Отмена" class="btn btn-danger hidden Cancellation" />
                        <input style="float:right;" name="@Items.TYPE_PU" type="button" value="Удалить" class="btn btn-danger hidden Delete" />
                        <input type="button" name="@Items.ID_PU" class="btn btn-primary HistoryEdit" value="История изменения" data-toggle="modal" data-target="#HistoryEditModal" />
                    }
                    else
                    {
                        <input type="button" name="@Items.FULL_LIC-@TypePU" class="btn btn-primary Archive" value="История расчётов ИПУ" data-toggle="modal" data-target="#ArchiveModal" />
                        <input type="button" name="@Items.ID_PU" class="btn btn-primary HistoryEdit" value="История изменения" data-toggle="modal" data-target="#HistoryEditModal" />
                        if (!string.IsNullOrEmpty(ViewBag.User))
                        {
                            <p class="text-center">В данный момент страницу редактирует  @ViewBag.User</p>
                        }
                        else
                        {<p class="text-center">ПО закрыто для изменений.</p>}
                    }
                </div>
            </div>
        }
    </div>
}
else
{
    <div class="container">
        <h3 class="text-center"></h3>
        <h1 class="text-center NullOrEmpty">По лицевому счету @ViewBag.FULL_LIC не найдено ПУ</h1>
        @if (ViewBag.isLock)
        {<p class="text-center">В данный момент страницу редактирует  @ViewBag.User</p>}
        <div class="col-md-12">
            <button id="CloseLock" name="@ViewBag.FULL_LIC" class="btn btn-success">Закрыть страницу</button>
            @if (ViewBag.ZAK != true)
            {
                <input type="button" name="@ViewBag.FULL_LIC" class="btn btn-primary AddPU" value="Добавить ПУ" data-toggle="modal" data-target="#AddPUModal" />
            }
            <a href="/counter/DetailedInformIPUDelete?FULL_LIC=@ViewBag.FULL_LIC" target="_blank"><input type="button" class="btn btn-primary AddPU" value="История ранее установленых ПУ" /></a>
            <a href="/PersonalData/DetailedInformPersData?FULL_LIC=@ViewBag.FULL_LIC" target="_blank"><input type="button" class="btn btn-primary AddPU" value="Персональные данные" /></a>
        </div>
        <div id="ResultSearchSave"></div>
    </div>

}
<div id="ResultArchive"></div>
<div id="HistoryEdit"></div>
<div id="FormAddPU"></div>
<script>
    function Loader() {
        $(".loader").addClass("hidden");
    }
    $(document).ready(function (e) {
        $(document).on('keypress', 'input,select', function (e) {
            if (e.which == 13) {
                e.preventDefault();
                var $next = $('[tabIndex=' + (+this.tabIndex + 1) + ']');
                console.log($next.length);
                if (!$next.length) {
                    $next = $('[tabIndex=1]');
                }
                $next.focus().click();
            }
        });
        setTimeout(Loader, 1000);
        $(".Archive").click(function (e) {
            var id_pu = $(e.target).attr("name");
            $(".loader").removeClass("hidden");
            $.ajax({
                url: '/Counter/ArchiveAllLics?id_pu=' + id_pu,
                type: 'Get',
                async: false,
                contentType: 'application/json; charset=utf-8',
                success: function (data) {
                    $("#ResultArchive").empty();
                    $("#ResultArchive").append(data);
                    $(".loader").addClass("hidden");
                },
                error: function () {
                    $(".loader").addClass("hidden");
                    alert("Что то пошло не так. Обратитесь к администратору");
                }
            });
        })
        $(".AddPU").click(function (e) {
            var FULL_LIC = $(e.target).attr("name");
            $(".loader").removeClass("hidden");
            $.ajax({
                url: '/Counter/FromAddPU?FullLIC=' + FULL_LIC,
                type: 'Get',
                async: false,
                contentType: 'application/json; charset=utf-8',
                success: function (data) {
                    $("#FormAddPU").empty();
                    $("#FormAddPU").append(data);
                    $(".loader").addClass("hidden");
                },
                error: function () {
                    $(".loader").addClass("hidden");
                    alert("Что то пошло не так. Обратитесь к администратору");
                }
            });
        })
        $(".HistoryEdit").click(function (e) {
            var id_pu = $(e.target).attr("name");
            $(".loader").removeClass("hidden");
            $.ajax({
                url: '/Counter/HistoryEdit?id_pu=' + id_pu,
                type: 'Get',
                async: false,
                contentType: 'application/json; charset=utf-8',
                success: function (data) {
                    $("#HistoryEdit").empty();
                    $("#HistoryEdit").append(data);
                    $(".loader").addClass("hidden");
                },
                error: function () {
                    $(".loader").addClass("hidden");
                    alert("Что то пошло не так. Обратитесь к администратору");
                }
            });
        })
        $(".Edit").click(function (e) {
            $(this).parent().find('input').prop('readonly', false);
            $('.Saled').prop('readonly', true);
            $(this).parent().find('select').prop('disabled', false);
            $(this).parent().find('input').removeClass('hidden');
            $(this).addClass("hidden");
            $(this).parent().find('.OVERWRITE').prop('disabled', false);
        })
        $(".OVERWRITE").click(function (e) {
            if ($(this).parent().find('.OVERWRITE').prop("checked")) {
                $('.Saled').prop('readonly', false);

            } else {
                $('.Saled').prop('readonly', true);
            }

        })
        $(".Cancellation").click(function (e) {
            $(this).addClass("hidden");
            $(this).parent().find('input').prop('readonly', true);
            $(this).parent().find('.Edit').removeClass('hidden');
            $(this).parent().find('.Delete').addClass('hidden');
            $(this).parent().find('.Save').addClass('hidden');
            $('.Saled').prop('readonly', true);
            $(this).parent().find('.OVERWRITE').prop('disabled', true);
            window.location.reload();
        })
        $(".Save").click(function (e) {
            $(".Save").addClass("hidden");

            var Param1 = parseFloat($(this).closest('.row').find('.SaledConfirm1')[0].value.replace(',','.'));
            var Param2 = parseFloat($(this).parent().find('.SaledConfirm2').val().replace(',', '.'));
            var Res = Param2 - Param1;
            if (Res < 0) {
                $(this).addClass("Required");
                $(this).closest('.row').find('.SaledConfirm1').addClass("Required");
                $.confirm({
                    title: 'Предупрждение!',
                    content: 'Внимание объем меньше нуля !!!',
                    buttons: {
                        "Ok": function () {

                        },
                    }
                });
                $(".Save").removeClass("hidden");
                return;
            }

            var NumberPU = $(this).parent().find('#NumberPU').val();
            var INSTALLATIONDATE = $(this).parent().find('#INSTALLATIONDATE').val();
            var DATE_CHECK = $(this).parent().find('#DATE_CHECK').val();
            var DATE_CHECK_NEXT = $(this).parent().find('#DATE_CHECK_NEXT').val();
            var date = new Date('@DateTime.Now.Date.ToString("yyyy-MM-dd")');
            var Maxdate = new Date('@DateTime.Now.AddYears(6).Date.ToString("yyyy-MM-dd")');
            if (INSTALLATIONDATE != undefined && new Date(INSTALLATIONDATE) > date) {
                alert("Дата акта ввода не должна быть позже @DateTime.Now.Date.ToString("dd-MM-yyyy")");
                $(".Save").removeClass("hidden");
                return;
            }
            if (DATE_CHECK != undefined && new Date(DATE_CHECK) > date) {
                alert("Дата поверки не должна быть позже @DateTime.Now.Date.ToString("yyyy-MM-dd")");
                $(".Save").removeClass("hidden");
                return;
            }
            if (DATE_CHECK_NEXT != undefined && new Date(DATE_CHECK_NEXT) > Maxdate) {
                alert("Дата следующей поверки не должна быть позже @DateTime.Now.AddYears(6).Date.ToString("dd-MM-yyyy") ");
                $(".Save").removeClass("hidden");
                return;
            }
            if (DATE_CHECK_NEXT != undefined && new Date(DATE_CHECK_NEXT) < new Date(DATE_CHECK)) {
                alert("Дата следующей поверки не должна быть меньше даты поверки");
                $(".Save").removeClass("hidden");
                return;
            }

            if ($(this).parent().find('.OVERWRITE').prop("checked")) {
                check = true;
            } else {
                check = false;
            }
            $.ajax({
                url: '/Counter/SaveIPU',
                type: 'POST',
                data: JSON.stringify({
                    saveModelIPU: {//missing brackets
                        IdPU: $(this).parent().find('.IdPU').val(),
                        FULL_LIC: $('#FULL_LIC').val(),
                        NumberPU: $(this).parent().find('#NumberPU').val(),
                        MODEL_PU: $(this).parent().find('#MODEL_PU option:selected').text(),
                        BRAND_PU: $(this).parent().find('#BRAND_PU option:selected').text(),
                        DATE_CHECK: $(this).parent().find('#DATE_CHECK').val(),
                        DATE_CHECK_NEXT: $(this).parent().find('#DATE_CHECK_NEXT').val(),
                        CHECKPOINT_DATE: $(this).parent().find('#CHECKPOINT_DATE').val(),
                        CHECKPOINT_READINGS: $(this).parent().find('#CHECKPOINT_READINGS').val()?.replace(',', '.'),
                        INSTALLATIONDATE: $(this).parent().find('#INSTALLATIONDATE').val(),
                        SEALNUMBER: $(this).parent().find('#SEALNUMBER').val(),
                        TYPEOFSEAL: $(this).parent().find('#TYPEOFSEAL').val().trim(),
                        InterVerificationInterval: $(this).parent().find('#InterVerificationInterval').val().trim(),
                        SEALNUMBER2: $(this).parent().find('#SEALNUMBER2').val(),
                        TYPEOFSEAL2: $(this).parent().find('#TYPEOFSEAL2').val().trim(),
                        DESCRIPTION: $(this).parent().find('.DESCRIPTION').val(),
                        OPERATOR_CLOSE_READINGS: $(this).parent().find('.OPERATOR_CLOSE_READINGS').val()?.replace(',', '.'),
                        OPERATOR_CLOSE_DATE: $(this).parent().find('#OPERATOR_CLOSE_DATE').val(),
                        OVERWRITE_SEAL: check,
                        FKUB2XVS: $(this).parent().find('#FKUB2XVS').val()?.replace('.', ','),
                        FKUB2XV_2: $(this).parent().find('#FKUB2XV_2').val()?.replace('.', ','),
                        FKUB2XV_3: $(this).parent().find('#FKUB2XV_3').val()?.replace('.', ','),
                        FKUB2XV_4: $(this).parent().find('#FKUB2XV_4').val()?.replace('.', ','),
                        FKUB2OT_1: $(this).parent().find('#FKUB2OT_1').val()?.replace('.', ','),
                        FKUB2OT_2: $(this).parent().find('#FKUB2OT_2').val()?.replace('.', ','),
                        FKUB2OT_3: $(this).parent().find('#FKUB2OT_3').val()?.replace('.', ','),
                        FKUB2OT_4: $(this).parent().find('#FKUB2OT_4').val()?.replace('.', ','),
                        FKUB1XVS: $(this).parent().find('#FKUB1XVS').val()?.replace('.', ','),
                        FKUB1XV_2: $(this).parent().find('#FKUB1XV_2').val()?.replace('.',','),
                        FKUB1XV_3: $(this).parent().find('#FKUB1XV_3').val()?.replace('.', ','),
                        FKUB1XV_4: $(this).parent().find('#FKUB1XV_4').val()?.replace('.', ','),
                        FKUB1OT_1: $(this).parent().find('#FKUB1OT_1').val()?.replace('.', ','),
                        FKUB1OT_2: $(this).parent().find('#FKUB1OT_2').val()?.replace('.', ','),
                        FKUB1OT_3: $(this).parent().find('#FKUB1OT_3').val()?.replace('.', ','),
                        FKUB1OT_4: $(this).parent().find('#FKUB1OT_4').val()?.replace('.', ','),
                        DIMENSION: {
                            ID: $(this).parent().find('#DIMENSION').val(),
                            Name: $(this).parent().find('#DIMENSION option:selected').text(),
                        }
                    }
                }),
                contentType: 'application/json; charset=utf-8',
                success: function (data) {
                    // alert(data + " Страница сейчас перезагрузится!");
                    if (data === "") {
                        window.location.reload();
                    } else { alert(data); }
                },
                error: function (data) {
                    alert(data);
                }
            });
            $(".Save").removeClass("hidden");
        })
        $(".Delete").click(function (e) {
            $(".Delete").addClass("hidden");
            var IdPU = $(this).parent().find('.IdPU').val();
            var CloseReadingError = $(this).parent().find('.OPERATOR_CLOSE_READINGS').val() == '' ?
                "Не заполнено поле дата закрытия" : '';
            var CloseDateError = $(this).parent().find('#OPERATOR_CLOSE_DATE').val() == '' ?
                "К.П. при закрытии" : '';
            console.log(CloseReadingError);
            console.log(CloseDateError)
            if (CloseReadingError != '' || CloseDateError != '') {
                $.confirm({
                    title: 'Исправьте ошибки прежде чем удалить ПУ !!!',
                    content: '' +
                        '<form action="" class="formName">' +
                        '<div class="form-group">' +
                        '<label>' + CloseReadingError + '</label>' +
                        '<label>' + CloseDateError + '</label>' +
                        '</div>' +
                        '</form>',
                    buttons: {
                        "Хорошо!": function () {
                            $.alert('Отменено!');
                            window.location.reload();
                        }
                    }
                });
            } else {
                $.confirm({
                    title: 'Предупрждение!',
                    content: 'Внимание вы пытаетесь удалить ПУ ' + $(this).attr('name') + ' !!!',
                    buttons: {
                        "Да": function () {
                            $.ajax({
                                url: '/Counter/DeletePU',
                                type: 'POST',
                                data: JSON.stringify({
                                    IdPU: IdPU
                                }),
                                contentType: 'application/json; charset=utf-8',
                                success: function (data) {
                                    // alert(data + " Страница сейчас перезагрузится!");
                                    window.location.reload();
                                },
                                error: function () {
                                    alert("Что то пошло не так. Обратитесь к администратору");
                                }
                            });
                        },
                        "Отмена": function () {
                            $.alert('Отменено!');
                            window.location.reload();
                        }
                    }
                });
            }
        })
        $(".DeleteError").click(function (e) {
            var lic = $('#FULL_LIC').val()
            var IdPU = $(this).parent().find('.IdPU').val();
            $.confirm({
                title: 'Предупрждение!',
                content: 'Внимание вы исправили ошибку ?',
                buttons: {
                    "Да": function () {
                        $.ajax({
                            url: '/Counter/DeleteError?IdPU=' + IdPU + '&Lic=' + lic,
                            type: 'POST',
                            data: JSON.stringify({
                                IdPU: IdPU
                            }),
                            contentType: 'application/json; charset=utf-8',
                            success: function (data) {
                                // alert(data + " Страница сейчас перезагрузится!");
                                window.location.reload();
                            },
                            error: function () {
                                alert("Что то пошло не так. Обратитесь к администратору");
                            }
                        });
                    },
                    "Нет": function () {
                        $.alert('Отменено!');
                    }
                }
            });
        })
        $("#CloseLock").click(function () {
            var Page = "DetailedInformIPU" + $("#CloseLock").attr("name");
            $.ajax({
                url: '/Counter/clearCache?Page=' + Page,
                type: 'Get',
                async: false,
                contentType: 'application/json; charset=utf-8',
                success: function (data) {
                    window.close();
                },
                error: function () {
                    alert("Что то пошло не так. Обратитесь к администратору");
                }
            });
        })
        $('.SaledConfirm2').blur(function (e) {
            var Param1 = parseFloat($(this).closest('.row').find('.SaledConfirm1')[0].value);
            var Param2 = parseFloat($(this).parent().find('.SaledConfirm2').val());
            var Res = Param2 - Param1;
            if (Res < 0) {
                $(this).addClass("Required");
                $(this).closest('.row').find('.SaledConfirm1').addClass("Required");
                $.confirm({
                    title: 'Предупрждение!',
                    content: 'Внимание объем меньше нуля !!!',
                    buttons: {
                        "Ok": function () {

                        },
                    }
                });
            }
        })
        $('.SaledConfirm2').keyup(function (e) {
            var Param1 = parseFloat($(this).closest('.row').find('.SaledConfirm1')[0].value.replace(",", "."));
            var Param2 = parseFloat($(this).parent().find('.SaledConfirm2').val().replace(",", "."));
            var Result = Param2 - Param1;
            $(this).closest('.row').find('.obem')[0].value = Result.toFixed(3);
        })
        $('.SaledConfirm1').keyup(function (e) {
            var Param1 = parseFloat($(this).closest('.row').find('.SaledConfirm2')[0].value.replace(",", "."));
            var Param2 = parseFloat($(this).parent().find('.SaledConfirm1').val().replace(",", "."));
            var Result = Param1 - Param2;
            $(this).closest('.row').find('.obem')[0].value = Result.toFixed(3);
        })
        $('.BRAND_PU').on('change', function (e) {
            var modelPu = $(this).closest('.card-body').find('#MODEL_PU option:selected');
            modelPu.empty().append(' ');
        });
        $('.MODEL_PU').on('focus', function (e) {
            $(".loader").addClass("hidden");
            var TypePu = $(this).closest('.card-body').find('.TypePU').val()?.replace(/[0-9]/i, '');
            var brandPu = $(this).closest('.card-body').find('#BRAND_PU option:selected').text();
            const ModelPu = $(this);
            $.ajax({
                url: `/Counter/GetDictionatyOption?Id=null&Text=${brandPu}&Type=MODEL_PU&TypePU=${TypePu}`,
                type: 'Get',
                async: false,
                contentType: 'application/json; charset=utf-8',
                success: function (data) {
                    ModelPu.empty().append(data);
                },
                error: function () {
                    $(".loader").addClass("hidden");
                    alert("Что то пошло не так. Обратитесь к администратору");
                }
            });
        })



    });
</script>